
-------- TESTING
SELECT * FROM USAGE_DAILY_V
   WHERE PROJECT_ID IN (
        '4CFA8C17-420E-4812-AA6B-544BB3AE49F9',
        '640315F5-4903-45A7-84C9-A8208B55492E');

---
SELECT * FROM USAGE_MINUTE_ROLLUP_WITH_PRICE WHERE PROJECT_ID IN ('4CFA8C17-420E-4812-AA6B-544BB3AE49F9', '640315F5-4903-45A7-84C9-A8208B55492E');
SELECT * FROM USAGE_MINUTE_ROLLUP WHERE BUCKET_UTC = '2025-09-29 15:18:00.000000 +00:00' AND RESOURCE_ID = 'B0DDD3D4-AE52-4F70-A22A-DD9A4A78C193';

---
SELECT * FROM PROCESSOR_PROVIDER_PRICING WHERE PROCESSOR_PROVIDER_ID = 'LANGUAGE/MODELS/OPENAI/GPT-5-CHAT-LATEST';
SELECT * FROM USAGE_MINUTE_ROLLUP;
SELECT * FROM USAGE_DAILY_V;
SELECT * FROM USAGE_HOURLY_V

SELECT *
  FROM USAGE_MONTHLY_V
 WHERE RESOURCE_TYPE LIKE '%ANTHROPIC%'
   AND PROJECT_ID = '4CFA8C17-420E-4812-AA6B-544BB3AE49F9';

SELECT P.PROJECT_NAME, U.* FROM USAGE_REPORT_DAILY_PRICING_V AS U
 INNER JOIN USER_PROJECT AS P
    ON P.PROJECT_ID = U.PROJECT_ID
 WHERE U.PROJECT_ID IN ('4CFA8C17-420E-4812-AA6B-544BB3AE49F9', '640315F5-4903-45A7-84C9-A8208B55492E')
   AND RESOURCE_TYPE LIKE 'LANGUAGE/MODELS/OPENAI/%'
 ORDER BY DAILY_UTC;


SELECT USER_ID,
       SUM(PCT_MINUTE_TOKENS_USED) AS PCT_MINUTE_TOKENS_USED,
       SUM(PCT_HOUR_TOKENS_USED) AS PCT_HOUR_TOKENS_USED,
       SUM(PCT_DAY_TOKENS_USED) AS PCT_DAY_TOKENS_USED,
       SUM(PCT_MONTH_TOKENS_USED) AS PCT_MONTH_TOKENS_USED,
       SUM(PCT_YEAR_TOKENS_USED) AS PCT_YEAR_TOKENS_USED,
       SUM(PCT_MINUTE_COST_USED) AS PCT_MINUTE_COST_USED,
       SUM(PCT_HOUR_COST_USED) AS PCT_HOUR_COST_USED,
       SUM(PCT_DAY_COST_USED) AS PCT_DAY_COST_USED,
       SUM(PCT_MONTH_COST_USED) AS PCT_MONTH_COST_USED,
       SUM(PCT_YEAR_COST_USED) AS PCT_YEAR_COST_USED
FROM USER_PROJECT_CURRENT_USAGE_REPORT WHERE USER_ID = 'DC688D73-AF47-B1DF-A24E-B7DFDB618B54'
                                       GROUP BY USER_ID
